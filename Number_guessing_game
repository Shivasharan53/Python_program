from flask import Flask, request, session, redirect, url_for, render_template_string
import random

app = Flask(__name__)
app.secret_key = 'your_secret_key'  # Required for session management

# HTML Template
HTML_TEMPLATE = """
<!DOCTYPE html>
<html>
<head>
    <title>Guess the Number</title>
</head>
<body>
    <h2>Guess the Number (1 to 100)</h2>
    {% if message %}
        <p><strong>{{ message }}</strong></p>
    {% endif %}
    <form method="post">
        <input type="number" name="guess" min="1" max="100" required>
        <input type="submit" value="Submit Guess">
    </form>
    <br>
    <form method="post" action="{{ url_for('reset') }}">
        <button type="submit">Reset Game</button>
    </form>
</body>
</html>
"""

@app.route('/', methods=['GET', 'POST'])
def index():
    if 'number' not in session:
        secret_number = random.randint(1, 100)
        session['number'] = secret_number
        session['attempts'] = 0
        print(f"[DEBUG] Secret number is: {secret_number}")  # <-- Print to terminal

    message = ""
    if request.method == 'POST':
        try:
            guess = int(request.form['guess'])
            session['attempts'] += 1
            number = session['number']

            if guess < number:
                message = "Too low! Try again."
            elif guess > number:
                message = "Too high! Try again."
            else:
                message = f"ðŸŽ‰ Correct! The number was {number}. You guessed it in {session['attempts']} attempts."
        except ValueError:
            message = "Invalid input. Please enter a number."

    return render_template_string(HTML_TEMPLATE, message=message)

@app.route('/reset', methods=['POST'])
def reset():
    session.pop('number', None)
    session.pop('attempts', None)
    return redirect(url_for('index'))

if __name__ == '__main__':
    app.run(debug=True)
